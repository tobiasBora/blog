<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>How this page is generated - Part 01</title>
  <link rel="stylesheet" href="../../assets/css/main.css" />
  <link rel="alternate" type="application/rss+xml" title="RSS Feed" href="../../rss.xml" />
  <link rel="alternate" type="application/atom+xml" title="Atom Feed" href="../../atom.xml" />
</head>

<body>
  <header id="header" class="uk-navbar-container">
  <div class="uk-container uk-flex uk-flex-column uk-flex-middle">

    <div class="uk-flex uk-flex-middle uk-width-1-1 uk-flex-wrap uk-margin-large-top uk-margin-medium-bottom">
      <div class="uk-container uk-flex uk-flex-right uk-flex-middle uk-width-expand@s uk-width-1-1">
        <span class="uk-text-right">
          <h1 class="uk-article-title">How this page is generated - Part 01</h1>
          <p>Introduction to Hakyll</p>
        </span>
      </div>
      <div class="uk-visible@s uk-width-auto">
        <hr class="uk-divider-vertical uk-margin-left uk-margin-right">
      </div>
      <div class="uk-container uk-flex uk-flex-column uk-flex-center uk-width-2-5@s uk-width-1-1 uk-text-muted uk-text-small">
        <ul class="uk-list">
          <li class="uk-flex">
            <span class="uk-margin-small-right uk-flex-none" uk-icon="calendar"></span>
            December 31, 2019
          </li>
          <li class="uk-flex">
            <span class="uk-margin-small-right uk-flex-none" uk-icon="clock"></span>
            9 Minutes
          </li>
          
          <li class="uk-flex-inline" style="overflow-wrap: break-word;">
            <span class="uk-margin-small-right uk-flex-none " uk-icon="bookmark"></span>
            
            <span>
              <a class="uk-text-emphasis uk-link-text" href="../../tags/internal.html">internal</a>,
              
            <span>
              <a class="uk-text-emphasis uk-link-text" href="../../tags/technical.html">technical</a>,
              
            <span>
              <a class="uk-text-emphasis uk-link-text" href="../../tags/haskell.html">haskell</a>
              </span>
          </li>
          
          <li class="uk-flex">
            <span class="uk-margin-small-right uk-flex-none" uk-icon="git-branch"></span>
            <a class="uk-link-muted" href="https://github.com/ysndr/blog/commit/fa0d118">fa0d118: Only render published posts</a>
          </li>

        </ul>
      </div>
    </div>
    <hr class="uk-width-1-1" />
  </div>

</header>


  <header class="uk-navbar-container uk-position-z-index uk-width-1-1" style="
    position: sticky;
    align-self: flex-start;
    top: 0;
">
  <nav class="uk-container" uk-navbar>

    <div class="uk-navbar-center ">
      <div class="uk-navbar-nav uk-flex-1">

        <li class="uk-logo"><a href="../../">
            <img src="../../assets/images/logo-small.svg" alt="y|sndr" class="logo" />
          </a>
        </li>

      </div>
    </div>

    <div class="uk-navbar-left">
      <ul class="uk-navbar-nav">
        <li>
          <a><span uk-navbar-toggle-icon></span> <span class="uk-margin-small-left">Menu</span></a>
          <div class="uk-navbar-dropdown" uk-drop="boundary: nav; boundary-align: true; pos: bottom-justify; offset: 0">

            <div class="uk-navbar-dropdown-grid uk-child-width-1-3@s uk-child-width-1-1" uk-grid>
              <div>
                <ul class="uk-nav uk-navbar-dropdown-nav">
                  <li class="uk-nav-header">Who?</li>
                  <li><a href="../../about.html">About Me</a></li>
                  <li><a href="https://gist.github.com/ysndr/978662957bb9187fd52b2037466e1e34">CV</a></li>
                  <li class="uk-nav-divider uk-margin-bottom"></li>
                  <li class>
                    <ul class="uk-iconnav uk-iconnav-horizontal">
                      <li><a href="mailto:contact@ysndr.de" uk-icon="mail"></a></li>
                      <li><a href="https://linkedin.com/in/yannik-sander" uk-icon="linkedin"></a>
                      </li>
                      <li><a href="https://github.com/ysndr" uk-icon="github"></a></li>
                    </ul>
                  </li>
                </ul>
              </div>
              <div>
                <ul class="uk-nav uk-navbar-dropdown-nav">
                  <li class="uk-nav-header">What?</li>
                  <li><a href="https://github.com/ysndr">Projects</a></li>
                  <li class="uk-nav-divider"></li>
                  <li><a href="https://github.com/ysndr/sam-knn-regressor">sam-knn-regressor</a></li>
                  <li><a href="https://github.com/ysndr/nixos-config">NixOS Config</a></li>
                </ul>
              </div>
              <div>
                <ul class="uk-nav uk-navbar-dropdown-nav">
                  <li class="uk-nav-header">Posts</li>
                  <li><a href="../../archive.html">Archive</a></li>
                  <li class="uk-flex">
                    <span uk-icon="rss" class="uk-text-muted"></span>
                    <ul class="uk-iconnav uk-subnav-divider">
                      <li><a href="../../rss.xml">RSS</a></li>
                      <li><a href="../../atom.xml">Atom</a></li>
                    </ul>
                  </li>
                  <li class="uk-nav-divider"></li>
                  <li><a href="https://github.com/ysndr/blog/commit/2d8ecbe"><span uk-icon="git-branch"></span>current rev.: 2d8ecbe: Fix a few typos in built-with-nix.</a></li>
                </ul>
              </div>
            </div>


          </div>
      </ul>
    </div>
    
    <div class="uk-navbar-right">
      <ul class="uk-navbar-nav">
        <li>
        <a><div class="uk-button uk-text-muted uk-button-default" type="button"><span class="uk-hidden@m">Content</span> <span class="uk-visible@m">Table of Contents</span></div></a>
        <div class="uk-navbar-dropdown y-toc" uk-drop="pos: bottom-right; offset: 0">
           <div class="uk-list" uk-scrollspy-nav="closest: li; scroll: true; offset: 85"><ul class="uk-nav-default uk-list uk-nav-sub"><li><a href="#hakyll-the-basics">Hakyll: The Basics</a><ul class="uk-nav-default uk-list uk-nav-sub"><li><a href="#setup">Setup</a></li><li><a href="#basic-concepts">Basic Concepts</a><ul class="uk-nav-default uk-list uk-nav-sub"><li><a href="#config">config</a></li><li><a href="#matching-routes">matching routes</a></li><li><a href="#compiling-with-pandoc">Compiling with Pandoc</a></li><li><a href="#creating-routes">Creating Routes</a></li><li><a href="#contexts">Contexts</a><ul class="uk-nav-default uk-list uk-nav-sub"><li><a href="#items">Items</a></li></ul></li></ul></li></ul></li></ul></div>
        </div>

      </li>


      </ul>
    </div>
    

  </nav>

</header>


  <main>
    <div class="uk-container">
      <section class="uk-section uk-padding-remove-op">
    
    
    <div class="uk-background-center-center uk-background-cover uk-height-medium uk-height-large@s uk-height-xlarge@m uk-flex uk-box-shadow-xlarge uk-margin-bottom" style="background-image: url(https://images.unsplash.com/photo-1576020363294-ab5dca00b6f8?w=1000); border-radius: 4px; ">
    <!-- <div class="uk-overlay uk-overlay-default uk-position-bottom">
        <p class="uk-text-lead uk-container"><i>This site is build with Hakyll, here I explain how.</i></p>
    </div> -->
    <div class="uk-container uk-flex uk-width-1-1 uk-flex-right uk-flex-bottom">
        <div class="uk-inline uk-padding-small">
            <div class="uk-button uk-background-muted uk-border-circle uk-drop-shadow-xlarge" style="line-height: 0; padding:4px;" type="button"><span uk-icon="info"></span></div>
            <div uk-drop="pos: top-right">
                <div class="uk-card uk-card-default uk-card-body uk-card-hover">
                    <h4 class="uk-card-title">Credits</h4>
                    
                    Picture taken by <a style="background-color:black;color:white;text-decoration:none;padding:4px 6px;font-family:-apple-system, BlinkMacSystemFont, &quot;San Francisco&quot;, &quot;Helvetica Neue&quot;, Helvetica, Ubuntu, Roboto, Noto, &quot;Segoe UI&quot;, Arial, sans-serif;font-size:12px;font-weight:bold;line-height:1.2;display:inline-block;border-radius:3px" href="https://unsplash.com/@mrsimonfischer?utm_medium=referral&amp;utm_campaign=photographer-credit&amp;utm_content=creditBadge" target="_blank" rel="noopener noreferrer" title="Download free do whatever you want high-resolution photos from Szymon Fischer"><span style="display:inline-block;padding:2px 3px"><svg xmlns="http://www.w3.org/2000/svg" style="height:12px;width:auto;position:relative;vertical-align:middle;top:-2px;fill:white" viewBox="0 0 32 32"><title>unsplash-logo</title><path d="M10 9V0h12v9H10zm12 5h10v18H0V14h10v9h12v-9z"></path></svg></span><span style="display:inline-block;padding:2px 3px">Szymon Fischer</span></a> on Unsplash
                    
                </div>
            </div>
        </div>
    </div>

</div>



    <article class="uk-article">

    <p class="uk-text-lead"><i>This site is build with Hakyll, here I explain how.</i></p>
    <p><h1 id="hakyll-the-basics">Hakyll: The Basics</h1>
<p>Hakyll is tool to build static webpages and written in Haskell borrowing part of its name from it and the other from the renown static site engine <a href="https://jekyllrb.com/">Jekyll</a>. The fundamental difference is that instead of being a standalone program, Hakyll is implemented as a library offering a rich DSL to define the contents of a website. The DSL can be used to include static assets, compile pages using templates and even generate whole pages by itself i.e.Â RSS and ATOM feeds. As Hakyll is written in Haskell combining it with the great text conversion tool <a href="https://pandoc.org/">pandoc</a> is a low hanging fruit. The combination of both allows compiling from several different file formats including (an extended version of) Markdown, <a href="http://docutils.sourceforge.net/docs/ref/rst/introduction.html">RST</a> and Emacs <a href="http://orgmode.org/">Org-Mode</a>.</p>
<div class="uk-alert-warning uk-alert warning">
<p><strong>Attention</strong></p>
<p><em>I wonât go into all the things used in this article, instead there will be individual posts going into more detail about different elements</em></p>
</div>
<ul>
<li>Part 01: Hakyll basics and context <em>(this article)</em></li>
<li>Part 02: <a href="./2020-03-22-built-with-hakyll-part-2.html">Custom Fields</a></li>
</ul>
<h2 id="setup">Setup</h2>
<p>Setting up Hakyll in general using stack or cabal is already documented extensively. My take on this project involves using <a href="https://nixos.org/nix/">nix</a> as dependency/package manager. How I set up this blog using nix will also be discussed another time.</p>
<h2 id="basic-concepts">Basic Concepts</h2>
<p>In this article I would like to introduce the basic concepts of Hakyll in an applied way.</p>
<p>The heart of this page is <a href="https://github.com/ysndr/blog/blob/release/generator/Main.hs"><code>generator/Main.hs</code></a>.</p>
<p>At itâs bare minimum a basic Hakyll generator looks like this:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="ot">config ::</span> <span class="dt">Configuration</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>config <span class="ot">=</span> defaultConfiguration {</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">-- config overrides such as the path to the page content source</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">-- and compiled item's destination</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co">-- A context extending the default context by a date field</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="ot">postCtx ::</span> <span class="dt">Tags</span> <span class="ot">-&gt;</span> <span class="dt">Tags</span> <span class="ot">-&gt;</span> <span class="dt">Context</span> <span class="dt">String</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>postCtx tags category <span class="ot">=</span> dateField <span class="st">&quot;date&quot;</span> <span class="st">&quot;%B %e, %Y&quot;</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>                     <span class="op">&lt;&gt;</span> defaultContext</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="ot">main ::</span> <span class="dt">IO</span> ()</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>main <span class="ot">=</span> hakyllWith config <span class="op">$</span> <span class="kw">do</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>    match <span class="st">&quot;posts/**.md&quot;</span> <span class="op">$</span> <span class="kw">do</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>        route <span class="op">$</span> setExtension <span class="st">&quot;html&quot;</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>        compile</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>            <span class="op">$</span>   pandocCompiler</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>            <span class="co">-- applies the post template</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>            <span class="op">&gt;&gt;=</span> loadAndApplyTemplate <span class="st">&quot;templates/post.html&quot;</span> postCtx</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>            <span class="co">-- embeds the rendered post into the page template</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>            <span class="op">&gt;&gt;=</span> loadAndApplyTemplate <span class="st">&quot;templates/default.html&quot;</span> postCtx</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>            <span class="op">&gt;&gt;=</span> relativizeUrls</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>    create [<span class="st">&quot;archive.html&quot;</span>] <span class="op">$</span> <span class="kw">do</span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>            route idRoute</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>            compile <span class="op">$</span> <span class="kw">do</span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>                posts <span class="ot">&lt;-</span> recentFirst <span class="op">=&lt;&lt;</span> loadAll <span class="st">&quot;posts/**&quot;</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>                <span class="kw">let</span> postCtx <span class="ot">=</span> postCtx tags categories</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>                <span class="kw">let</span> archiveCtx <span class="ot">=</span> listField <span class="st">&quot;posts&quot;</span> postCtx (<span class="fu">return</span> posts)</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>                            <span class="op">&lt;&gt;</span> constField <span class="st">&quot;title&quot;</span> <span class="st">&quot;Archive&quot;</span></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>                            <span class="op">&lt;&gt;</span> customBaseContext</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>                makeItem <span class="st">&quot;&quot;</span></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>                    <span class="op">&gt;&gt;=</span> loadAndApplyTemplate <span class="st">&quot;templates/archive.html&quot;</span> archiveCtx</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>                    <span class="op">&gt;&gt;=</span> loadAndApplyTemplate <span class="st">&quot;templates/default.html&quot;</span> archiveCtx</span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>                    <span class="op">&gt;&gt;=</span> relativizeUrls</span></code></pre></div>
<p>This will render all markdown files under <code>posts/</code> to html files under our build route and setup an archive site listing all posts.</p>
<p>In this snipped we see several things lets go through them individually:</p>
<ol type="1">
<li>config</li>
<li>matching routes</li>
<li>compiling with pandoc</li>
<li>templates</li>
<li>contexts</li>
</ol>
<h3 id="config">config</h3>
<div class="sourceCode" id="cb2"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="ot">config ::</span> <span class="dt">Configuration</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>config <span class="ot">=</span> defaultConfiguration { }</span></code></pre></div>
<p>This sets up the runtime configuration of hakyll itself. With it we can override among others the folder in which Hakyll searches for its content and where the result should be stored. All available options can be found inside the <a href="https://jaspervdj.be/hakyll/reference/Hakyll-Core-Configuration.html">documentation</a></p>
<h3 id="matching-routes">matching routes</h3>
<div class="sourceCode" id="cb3"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>match <span class="st">&quot;posts/**.md&quot;</span> <span class="op">$</span> <span class="kw">do</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>    route <span class="op">$</span> setExtension <span class="st">&quot;html&quot;</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    compile</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>        <span class="op">$</span>   pandocCompiler</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>        <span class="co">-- applies the post template</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>        <span class="op">&gt;&gt;=</span> loadAndApplyTemplate <span class="st">&quot;templates/post.html&quot;</span> postCtx</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>        <span class="co">-- embeds the rendered post into the page template</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>        <span class="op">&gt;&gt;=</span> loadAndApplyTemplate <span class="st">&quot;templates/default.html&quot;</span> postCtx</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>        <span class="op">&gt;&gt;=</span> relativizeUrls</span></code></pre></div>
<p>In order to create a page from an existing source we use the match function. It takes a <code>FilePath</code> and a function telling it what to do with the file. <code>route</code> will then map the matched items to the paths created by <code>setExtension</code> which unsurprisingly only changes the resulting files extension to <code>html</code>. There are a few other functions that can be used here (basically all functions that return <code>Routes</code>). Those can be used to do more advanced route editing such as creating fancy paths using <code>index.html</code><a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>.</p>
<p>But what does this function actually do in particular? 1. It searches for all markdown files under the <code>posts/</code> directory. 2. Defines their final route 3. Compiles them to html using pandoc 4. Embedds them into a post template 5. Embedds raw posts into the default page template 6. And finally relativizes urls, which is a fancy function that keeps track of the resources referenced locally and keeps their links up to date.</p>
<h3 id="compiling-with-pandoc">Compiling with Pandoc</h3>
<p>In the snippet above the default <code>pandocCompiler</code> function is used to read the content of the file and transform it into HTML using Hakyllâs default options for pandoc. Aside <code>pandocCompiler</code> there are a few more low level functions available that allow deeper customization in the regards of which pandoc templates are used, which extensions activated and so forth. There are also <code>pandocCompilerWithTransform</code> and <code>pandocCompilerWithTransformM</code> that allow editing the intermediate parsed content pandoc uses internally. At this point rich postprocessing can be applied, just alike the usual pandoc filters. The only grain is that existing pandoc filters (i.e.Â <a href="https://github.com/jgm/pandocfilters">pandocfilters</a> or <a href="https://github.com/sergiocorreia/panflute">panflute</a>) cannot be easily applied with Hakyll.</p>
<h3 id="creating-routes">Creating Routes</h3>
<p>Additionally to matching existing files and compiling them, one can also generate fully independent files using the <code>create</code> function.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>create [<span class="st">&quot;archive.html&quot;</span>] <span class="op">$</span> <span class="kw">do</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>    route idRoute</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>    compile <span class="op">$</span> <span class="kw">do</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>        posts <span class="ot">&lt;-</span> recentFirst <span class="op">=&lt;&lt;</span> loadAll <span class="st">&quot;posts/**&quot;</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>        <span class="kw">let</span> postCtx <span class="ot">=</span> postCtx tags categories</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>        <span class="kw">let</span> archiveCtx <span class="ot">=</span> listField <span class="st">&quot;posts&quot;</span> postCtx (<span class="fu">return</span> posts)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>                    <span class="op">&lt;&gt;</span> constField <span class="st">&quot;title&quot;</span> <span class="st">&quot;Archive&quot;</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>                    <span class="op">&lt;&gt;</span> customBaseContext</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>        makeItem <span class="st">&quot;&quot;</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>            <span class="op">&gt;&gt;=</span> loadAndApplyTemplate <span class="st">&quot;templates/archive.html&quot;</span> archiveCtx</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>            <span class="op">&gt;&gt;=</span> loadAndApplyTemplate <span class="st">&quot;templates/default.html&quot;</span> archiveCtx</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>            <span class="op">&gt;&gt;=</span> relativizeUrls</span></code></pre></div>
<p>This creates a files <code>archive.html</code> which is built using the compile function that basically wraps an <code>Item a</code> in the <code>Compiler</code> monad. The corresponding item is created using <code>makeItem</code> that itroduces an empty String Item that is enriched first using the archive template and subsequently the default page template.</p>
<p>Notice the use of <code>loadAll</code> that makes the set of all posts availlable inside he compile scope. Most importantly though are the both contexts, especially the <code>archiveCtx</code> that makes the posts available to the template engine as a list of <code>postCtx</code>s.</p>
<h3 id="contexts">Contexts</h3>
<p>Contexts contain the meta information that is available to the templating engine when building an <code>Item</code>. Thus allowing the usage of the computed value in the template files. A context holds a number of fields which are contexts as well. Each fieldâs value is created for every compilation item (this is every item the context will be applied on, usually individual posts).</p>
<p>Take for example the following field definition:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>peekField</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="ot">    ::</span> <span class="dt">String</span>           <span class="co">-- ^ Key to use</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    <span class="ot">-&gt;</span> <span class="dt">Int</span>              <span class="co">-- ^ length to peak</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    <span class="ot">-&gt;</span> <span class="dt">Snapshot</span>         <span class="co">-- ^ Snapshot to load</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    <span class="ot">-&gt;</span> <span class="dt">Context</span> <span class="dt">String</span>   <span class="co">-- ^ Resulting context</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>peekField key <span class="fu">length</span> snapshot <span class="ot">=</span> field key <span class="op">$</span> \item <span class="ot">-&gt;</span> <span class="kw">do</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>    body <span class="ot">&lt;-</span> itemBody <span class="op">&lt;$&gt;</span> loadSnapshot (itemIdentifier item) snapshot</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span> (peak body)</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">where</span> peak <span class="ot">=</span> T.unpack <span class="op">.</span> T.unwords <span class="op">.</span> <span class="fu">take</span> <span class="fu">length</span> <span class="op">.</span> T.words <span class="op">.</span> T.pack</span></code></pre></div>
<p>This is a very simple field once created to serve as my own version of a teaser field. As you can see a <code>field</code> is created from a key and a function mapping an item to a string. In this case the itemâs body is extracted from a <a href="https://jaspervdj.be/hakyll/tutorials/05-snapshots-feeds.html#snapshots">snapshot</a> of the itemâs content. Then <code>length</code> words are taken and returned. (If you are in the actual need of a teaser field I would advice you though to use the <a href="https://jaspervdj.be/hakyll/reference/Hakyll-Web-Template-Context.html#v:teaserField"><code>teaserField</code></a>).</p>
<p>Yet what this example demonstate is the integral importance of <code>Item</code>s in Hakyll.</p>
<h4 id="items">Items</h4>
<p><code>Item</code>s are a simple datatypes that wrap a <code>body</code> of some type <code>a</code> (usually <code>String</code>) and an identifier.</p>
<p>Most of Hakyllâs functions that deal with content are working with <code>Item</code>s. As seen above <code>Item</code>s can also be stored in snapshots and retrieved later on. Especially in <code>field</code>s <code>Item</code>s contain the content from which the desired <code>field</code> can be derived from.</p>
<hr />
<p>I donât mean to write an extensive documentation of all the concepts in Hakyll, an complete introductory tutorial as well as links to other peoples takes can be found at Jasperâs (the founder of Hakyll) <a href="https://jaspervdj.be/hakyll/tutorials.html">website</a>.</p>
<p>In a follow up article I would like to share a compilation of custom fields that I created or adapted from other blogs.</p>
<section class="footnotes" role="doc-endnotes">
<hr />
<ol>
<li id="fn1" role="doc-endnote"><p><a href="rohanjain.in/hakyll-clean-urls/">rohanjain.in/hakyll-clean-urls/</a><a href="#fnref1" class="footnote-back" role="doc-backlink">â©ï¸</a></p></li>
</ol>
</section></p>

</article>

</section>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-AMS_CHTML-full" type="text/javascript"></script>
<!--[if lt IE 9]>
  <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
<![endif]-->

    </div>
  </main>


  <footer class="uk-section uk-section-secondary ">
    <div class="uk-container">
      <div class="uk-grid-medium uk-child-width-1-3@m uk-child-width-1-1" uk-grid>
        <div>
          <div class>
            <h3 class>Contact</h3>
            <p><span uk-icon="mail"></span> <a href="mailto:contact@ysndr.de">contact@ysndr.de</a></p>
            <p><span uk-icon="github"></span> <a href="https://github.com/ysndr">ysndr</a></p>
            <p><span uk-icon="linkedin"></span> <a href="https://linkedin.com/in/yannik-sander">yannik-sander</a></p>
          </div>
        </div>
        <div>
          <div class>
            <h3 class>Legal</h3>
            <p><span uk-icon="check"></span> <span href="mailto:contact@ysndr.de">No analytics are used here your data is
                safe :)</span></p>
            <p><span uk-icon="check"></span> <span href="https://github.com/ysndr">The content of this blog is licensed under
                CC0 terms if not otherwise noted</span></p>
          </div>
        </div>
        <div>
          <div class>
            <h3 class>About this blog</h3>
            <p>Built with <span uk-icon="code"></span> and <span uk-icon="heart"></span> using <a href="https://jaspervdj.be/hakyll/">Hakyll</a></p>
            <p><a href="https://builtwithnix.org" rel="nofollow"><img src="https://builtwithnix.org/badge.svg" " style="max-width:100%;"></a></p>
            <p class="uk-text-muted"><span uk-icon="git-branch"></span> last updated: <a href="https://github.com/ysndr/blog">2d8ecbe: Fix a few typos in built-with-nix. (2020-07-04 14:31:17 +0200)</a>
            </p>
          </div>
        </div>
      </div>
    </div>

    </div>
    </div>
  </footer>


  <script src="https://cdnjs.cloudflare.com/ajax/libs/uikit/3.2.0/js/uikit.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/uikit/3.2.0/js/uikit-icons.min.js"></script>
</body>

</html>
